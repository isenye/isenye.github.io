<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  
  
  <title>  GARCH模型及拟合案例 |   城中乌 </title>

 
  
    <link rel="icon" href="/images/favicon.png">
  


  <link rel="stylesheet" href="/nayo.min.css"> 
</head>  
  <body>   
    
      <header class="header">
	
  <nav class="header-nav">        

    <span class="iconfont icon-menu mobile-toggle"></span>   	

    <div class="header-logo">
      <a href="/">
        <img class="header-logo-img" src="/images/logo.png">
      </a>
    </div>

    <div class="header-menu">          
              
          
            <a class="header-menu-link" id="header-menu-home" href="/">
              <i class="iconfont icon-home">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-archives" href="/archives">
              <i class="iconfont icon-archives">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-tags" href="/tags">
              <i class="iconfont icon-tags">  
            </i></a>     
          
              
          
            <a class="header-menu-link" id="header-menu-about" href="/about">
              <i class="iconfont icon-about">  
            </i></a>     
          
              
          
              <a class="header-menu-link" id="header-menu-search">
                <i class="iconfont icon-search">  
              </i></a>
          
                  
    </div>  
    
  </nav>
</header>

   

      <div class="container">       
          
          
            <section class="main">  
          

          <article class="post">
  
	<div class="post-header">

	<p class="post-title">	
		GARCH模型及拟合案例
	</p>
			

	<div class="meta-info">	
	<span>
		11月 24, 2018
	</span>

	
	
		<i class="iconfont icon-words"></i>
		<span>
			3555
		</span>
	
</div>

</div> 
	
    <script type="text/x-mathjax-config">
        var post = document.getElementsByClassName("post")[0];  
        MathJax.Hub.Config({
            showProcessingMessages: false,
            messageStyle: "none",    
            tex2jax: {
                inlineMath:  [ ["$", "$"] , ["\\(","\\)"]],
                displayMath: [ ["$$","$$"] , ["\\[","\\]"]],
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'],
            },
            "HTML-CSS": {            
                showMathMenu: false
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub,post]);
    </script>
    <style>.MathJax{outline:0;}</style>

    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.2/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
 

	  <div class="typo post-content slideDownMin">

		

			
					<h5 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h5><blockquote>
<p>实践中,残差序列的异方差函数具有长期自相关性,这是ARCH模型拟合会采用高阶的移动平均阶数,这导致参数估计的难度加大并最终影响ARCH模型的拟合精度</p>
</blockquote>
<a id="more"></a>
<hr>
<h4 id="理论依据"><a href="#理论依据" class="headerlink" title="理论依据"></a>理论依据</h4><h6 id="1-ARCH模型的局限"><a href="#1-ARCH模型的局限" class="headerlink" title="1. ARCH模型的局限"></a>1. ARCH模型的局限</h6><p>ARCH模型的实质,使用残差平方序列的q阶移动平均拟合当期异方差函数值,由于移动平均模型具有自相关系数q阶截尾性.所以ARCH模型实际上只适用于异方差函数短期自相关过程拟合</p>
<h6 id="2-GARCH-p-q-模型的提出"><a href="#2-GARCH-p-q-模型的提出" class="headerlink" title="2. GARCH(p,q)模型的提出"></a>2. GARCH(p,q)模型的提出</h6><p>全称为 <em>广义自回归条件异方差模型 (generalized autoregressive conditionalheteroskedastic)</em> ,针对残差序列具有长期相关性拟合合适的模型,结构如下:<br><img src="/assets/garch_1/a.png" alt=""></p>
<ul>
<li>$x_t=f(t,x_{t-1}…)+ε_t$提取确定性信息</li>
<li>$ε_t$残差序列,可能需要拟合自回归提取相关性</li>
<li>$h_t$包含ARCH和GARCH项,对方差非齐进行拟合</li>
</ul>
<h6 id="3-AR-GARCH模型"><a href="#3-AR-GARCH模型" class="headerlink" title="3. AR-GARCH模型"></a>3. AR-GARCH模型</h6><p>当对原序列提取确定性信息不充分时,$ε_t$可能具有相关性,而不是纯随机性.这时可能先对$ε_t$拟合回归模型,在考察回归残差序列$ν_t$的方差齐性</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="/assets/garch_1/b.png" alt=""></h2><h4 id="拟合案例"><a href="#拟合案例" class="headerlink" title="拟合案例"></a>拟合案例</h4><h6 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述:"></a>问题描述:</h6><ul>
<li>1969年1月至1994年8月澳大利亚储备银行2年期有价证券阅读利率数据如下;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">4.99	5		5.03	5.03	5.25	5.26	5.3		5.45	5.49	5.52	5.7</span><br><span class="line">5.68	5.65	5.8		6.5		6.45	6.48	6.45	6.35	6.4		6.43	6.43</span><br><span class="line">6.44	6.45	6.48	6.4		6.35	6.4		6.3		6.32	6.35	6.13	5.7</span><br><span class="line">5.58	5.18	5.18	5.17	5.15	5.21	5.23	5.05	4.65	4.65	4.6</span><br><span class="line">4.67	4.69	4.68	4.62	4.63	4.9		5.44	5.56	6.04	6.06	6.06</span><br><span class="line">8.07	8.07	8.1		8.05	8.06	8.07	8.06	8.11	8.6		10.8	11</span><br><span class="line">11		11		9.48	9.18	8.62	8.3		8.47	8.44	8.44	8.46	8.49</span><br><span class="line">8.54	8.54	8.5		8.44	8.49	8.4		8.46	8.5		8.5		8.47	8.47</span><br><span class="line">8.47	8.48	8.48	8.54	8.56	8.39	8.89	9.91	9.89	9.91	9.91</span><br><span class="line">9.9		9.88	9.86	9.86	9.74	9.42	9.27	9.26	8.99	8.83	8.83</span><br><span class="line">8.83	8.82	8.83	8.83	8.79	8.79	8.69	8.66	8.67	8.72	8.77</span><br><span class="line">9		9.61	9.7		9.94	9.94	9.94	9.95	9.94	9.96	9.97	10.83</span><br><span class="line">10.75	11.2	11.4	11.54	11.5	11.34	11.5	11.5	11.58	12.42	12.85</span><br><span class="line">13.1	13.12	13.1	13.15	13.1	13.2	14.2	14.75	14.6	14.6	14.45</span><br><span class="line">14.5	14.8	15.85	16.2	16.5	16.4	16.4	16.35	16.1	13.7	13.5</span><br><span class="line">14		12.3	12		14.35	14.6	12.5	12.75	13.7	13.45	13.55	12.6</span><br><span class="line">12		11		11.6	12.05	12.35	12.7	12.45	12.55	12.2	12.1	11.15</span><br><span class="line">11.85	12.1	12.5	12.9	12.5	13.2	13.65	13.65	13.5	13.45	13.35</span><br><span class="line">14.45	14.3	15.05	15.55	15.65	14.65	14.15	13.3	12.65	12.7	12.8</span><br><span class="line">14.5	15.1	15.15	14.3	14.25	14.05	14.7	15.05	14.05	13.8	13.25</span><br><span class="line">13		12.85	12.6	11.8	13		12.35	11.45	11.35	11.55	10.85	10.9</span><br><span class="line">12.3	11.7	12.05	12.3	12.9	13.05	13.3	13.85	14.65	15.05	15.15</span><br><span class="line">14.85	15.7	15.4	15.1	14.8	15.8	15.8	15		14.4	13.8	14.3</span><br><span class="line">14.15	14.45	14.1	14.05	13.75	13.3	13		12.55	12.25	11.85	11.5</span><br><span class="line">11.1	11.15	10.7	10.25	10.55	10.25	10.3	9.6		8.4		8.2		7.25</span><br><span class="line">8.35	8.25	8.3		7.4		7.15	6.35	5.65	7.4		7.2		7.05	7.1</span><br><span class="line">6.85	6.5		6.25	5.95	5.65	5.85	5.45	5.3		5.2		5.55	5.15</span><br><span class="line">5.4		5.35	5.1		5.8		6.35	6.5		6.95	8.05	7.75	8.6</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>1.考察方差齐性;<br>2.选择适当的模型拟合该序列的发展;</p>
<hr>
<h6 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤:"></a>解题步骤:</h6><h6 id="1-建立数据集和时间"><a href="#1-建立数据集和时间" class="headerlink" title="1. 建立数据集和时间"></a>1. 建立数据集和时间</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data a;</span><br><span class="line">input x@@;</span><br><span class="line">lagx=lag(x);</span><br><span class="line">difx=dif(x);</span><br><span class="line">t=intnx(&apos;month&apos;,&apos;1jan1969&apos;d,_n_-1);</span><br><span class="line">cards;</span><br><span class="line">....  # 数据</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<h6 id="2-对原序列和一阶差分后序列进行时序图绘制"><a href="#2-对原序列和一阶差分后序列进行时序图绘制" class="headerlink" title="2. 对原序列和一阶差分后序列进行时序图绘制"></a>2. 对原序列和一阶差分后序列进行时序图绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc gplot data=a;</span><br><span class="line">plot x*t difx*t;</span><br><span class="line">symbol c=red i=join v=star;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
<p><img src="/assets/garch_1/1.png" alt="x*t"></p>
<p><img src="/assets/garch_1/2.png" alt="difx*t"></p>
<h2 id="分析-原序列非平稳-一阶差分序列平稳且存在异方差现象-集群效应"><a href="#分析-原序列非平稳-一阶差分序列平稳且存在异方差现象-集群效应" class="headerlink" title="分析 : 原序列非平稳,一阶差分序列平稳且存在异方差现象(集群效应)"></a><em>分析</em> : 原序列非平稳,一阶差分序列平稳且存在异方差现象(<em>集群效应</em>)</h2><h6 id="3-绘制原序列和一阶差分序列相关图"><a href="#3-绘制原序列和一阶差分序列相关图" class="headerlink" title="3.绘制原序列和一阶差分序列相关图"></a>3.绘制原序列和一阶差分序列相关图</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc arima data=a;</span><br><span class="line">identify var=x;</span><br><span class="line">identify var=x(1);</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
<p><img src="/images/placeholder.png" alt="原序列相关图" data-src="/assets/garch_1/3.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="一阶差分序列相关图" data-src="/assets/garch_1/4.png" class="lazyload"></p>
<h2 id="分析-原序列长期相关-一阶差分序列具有平稳性-但也存在拖尾"><a href="#分析-原序列长期相关-一阶差分序列具有平稳性-但也存在拖尾" class="headerlink" title="分析 : 原序列长期相关,一阶差分序列具有平稳性,但也存在拖尾"></a><em>分析</em> : 原序列长期相关,一阶差分序列具有平稳性,但也存在拖尾</h2><h6 id="4-对原序列提取趋势信息-绘制残差序列五阶自相关图-并对残差序列进行dw检验-确定相关性信息"><a href="#4-对原序列提取趋势信息-绘制残差序列五阶自相关图-并对残差序列进行dw检验-确定相关性信息" class="headerlink" title="4. 对原序列提取趋势信息,绘制残差序列五阶自相关图,并对残差序列进行dw检验,确定相关性信息"></a>4. 对原序列提取趋势信息,绘制残差序列五阶自相关图,并对残差序列进行dw检验,确定相关性信息</h6><p><strong>提取方式</strong></p>
<ul>
<li>自变量t的幂函数提取趋势信息<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=5 dwprob ;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/images/placeholder.png" alt="参数检测" data-src="/assets/garch_1/5.png" class="lazyload"></p>
<ul>
<li>滞后变量的方式提取<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=lagx/ lagdep=lagx nlag=5 dwprob; # 均值不显著,可添加 noint</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/images/placeholder.png" alt="参数检测" data-src="/assets/garch_1/6.png" class="lazyload"><br><strong>五阶相关图</strong><br><img src="/images/placeholder.png" alt="t提取" data-src="/assets/garch_1/7.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="lagx提取" data-src="/assets/garch_1/8.png" class="lazyload"></p>
<p><em>残差自相关仍具有相关和拖尾特征,残差序列仍有相关性</em></p>
<p><strong>dw检验</strong><br><img src="/images/placeholder.png" alt="t提取" data-src="/assets/garch_1/9.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="lagx提取" data-src="/assets/garch_1/10.png" class="lazyload"></p>
<p><em>两者提取后的残差序列仍具有相关性</em></p>
<hr>
<h6 id="5-对第一次残差拟合一次AR-2-模型-并对第二次残差进行archtest检验"><a href="#5-对第一次残差拟合一次AR-2-模型-并对第二次残差进行archtest检验" class="headerlink" title="5. 对第一次残差拟合一次AR(2)模型,并对第二次残差进行archtest检验"></a>5. 对第一次残差拟合一次AR(2)模型,并对第二次残差进行archtest检验</h6><p><strong>第一次残差拟合</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=5 noint backstep method=ml archtest;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p>
<p><img src="/images/placeholder.png" alt="AR(2)参数通过检验" data-src="/assets/garch_1/11.png" class="lazyload"></p>
<p><strong>archtest检测</strong><br><img src="/images/placeholder.png" alt="Q.LM检测" data-src="/assets/garch_1/12.png" class="lazyload"><br><em>对$ε_t$拟合AR(2),Q.LM检测显示长期相关性,可以拟合GARCH模型</em></p>
<h6 id="6-最终模型拟合AR-2-GARCH-1-1"><a href="#6-最终模型拟合AR-2-GARCH-1-1" class="headerlink" title="6. 最终模型拟合AR(2)-GARCH(1,1)"></a>6. 最终模型拟合AR(2)-GARCH(1,1)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=2 noint garch=(p=1,q=1);</span><br><span class="line">output out=out p=p lcl=lcl ucl=ucl cev=cev residual=residual;  # 数据输出</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
<p><img src="/images/placeholder.png" alt="参数检验" data-src="/assets/garch_1/13.png" class="lazyload"></p>
<h6 id="7-绘制"><a href="#7-绘制" class="headerlink" title="7. 绘制"></a>7. 绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">data out;</span><br><span class="line">set out;</span><br><span class="line">lcl_residul=-1.96*sqrt(0.27415);</span><br><span class="line">Ucl_residul=1.96*sqrt(0.27415);</span><br><span class="line">Lcl_GARCH=-1.96*sqrt(cev);</span><br><span class="line">Ucl_GARCH=1.96*sqrt(cev);</span><br><span class="line">Lcl_P=P-1.96*sqrt(cev);</span><br><span class="line">Ucl_P=P+1.96*sqrt(cev);</span><br><span class="line">proc gplot data=out;</span><br><span class="line">plot x*t=5  lcl*t=3 ucl*t=3 Lcl_P*t=4 Ucl_P*t=4/overlay;</span><br><span class="line">plot residual*t=2 lcl_residul*t=3 Ucl_residul*t=3 Lcl_GARCH*t=4 Ucl_GARCH*t=4/overlay;</span><br><span class="line">symbol2 c=green i=needle v=none;</span><br><span class="line">symbol3 c=black i=join v=none w=2 l=2;</span><br><span class="line">symbol4 c=red i=join v=none;</span><br><span class="line">symbol5 c=green i=join v=none;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure>
<p><img src="/images/placeholder.png" alt="拟合图" data-src="/assets/garch_1/14.png" class="lazyload"></p>
<p><img src="/images/placeholder.png" alt="残差波动拟合" data-src="/assets/garch_1/15.png" class="lazyload"></p>
  	
					
	  </div>     
	  

	<div class="post-footer">

  <div class="post-footer-other">
      <span class="post-footer-item">
         
      </span>           
      <span class="post-footer-item">
        
      </span>           
  </div>  

  <div class="post-footer-meta">
        	

        
          <i class="iconfont icon-tag"></i>     
            <a class="tag-link" href="/tags/SAS/">SAS</a> <a class="tag-link" href="/tags/时间序列/">时间序列</a>    
        	
  </div>

</div>


<nav class="post-footer-nav">
  
  
    <div class="post-footer-link">
      <a href="/2018/11/21/arch-1/" id="post-nav-older" class="post-nav-link-wrap">
        <strong class="post-nav-caption">older</strong>
        
          <a class="post-nav-title" href="/2018/11/21/arch-1/">
          ARCH模型拟合案例</a>
      </a>
    </div>
  
</nav>
 
	
	
</article>

          </section> 
      </div>            
    
    <a id="backTop">
      <span>
        <i class="iconfont icon-backtotop"></i>
      </span>
    </a> 

  
    
    <div class="search-container sildeUpMin">
        <div class="search-header">
            <input type="text" placeholder="= = ||" id="search-input" class="search-input">
            <span class="search-cancel">
                <i class="iconfont icon-cancel">
            </i></span>
        </div>
        <div id="search-result" class="search-result"></div>
    </div>
 
     <div class="mobile-menu">      

      
      <img class="mobile-menu-icon lazyload" src="/images/placeholder.png" data-src="/images/favicon.png">   
      

         
            

            <a class="mobile-menu-link" href="/">首页
            </a>
            
         
            

            <a class="mobile-menu-link" href="/archives">归档
            </a>
            
         
            

            <a class="mobile-menu-link" href="/tags">标签
            </a>
            
         
            

            <a class="mobile-menu-link" href="/about">关于
            </a>
            
         
                          

            <a class="mobile-menu-link mobile-menu-search" href="#">搜索 </a>                 
            
         
      
</div>        
    



     
    




<footer id="footer">	    

		
		<div class="footer-copyright">
		&copy;
		
		2018		
	
		arnold
		<br>

		Theme by
		<a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a>	
		</div>			
	 
</footer>   

  

    <script src="/nayo.bundle.js"></script>

    


    <script type="text/javascript" color="0,49,79" opacity="0.6" zindex="-2" count="60" src="https://cdn.bootcss.com/canvas-nest.js/2.0.2/canvas-nest.js"></script>

    <!-- <script type="text/javascript"
    color="0,49,79" opacity='0.6' zIndex="-2" count="120" src="https://cdn.bootcss.com/canvas-nest.js/2.0.3/canvas-nest.js"></script> -->

  </body>        
</html>