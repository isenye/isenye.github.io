<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>GARCH模型及拟合案例</title>
      <link href="/2018/11/24/garch/"/>
      <content type="html"><![CDATA[<blockquote><p>实践中,残差序列的异方差函数具有长期自相关性,这是ARCH模型拟合会采用高阶的移动平均阶数,这导致参数估计的难度加大并最终影响ARCH模型的拟合精度</p></blockquote><a id="more"></a><hr><h4 id="理论依据"><a href="#理论依据" class="headerlink" title="理论依据"></a>理论依据</h4><h6 id="1-ARCH模型的局限"><a href="#1-ARCH模型的局限" class="headerlink" title="1. ARCH模型的局限"></a>1. ARCH模型的局限</h6><p>ARCH模型的实质,使用残差平方序列的q阶移动平均拟合当期异方差函数值,由于移动平均模型具有自相关系数q阶截尾性.所以ARCH模型实际上只适用于异方差函数短期自相关过程拟合</p><h6 id="2-GARCH-p-q-模型的提出"><a href="#2-GARCH-p-q-模型的提出" class="headerlink" title="2. GARCH(p,q)模型的提出"></a>2. GARCH(p,q)模型的提出</h6><p>全称为 <em>广义自回归条件异方差模型 (generalized autoregressive conditionalheteroskedastic)</em> ,针对残差序列具有长期相关性拟合合适的模型,结构如下:<br><img src="/assets/garch_1/a.png" alt=""></p><ul><li>$x_t=f(t,x_{t-1}…)+ε_t$提取确定性信息</li><li>$ε_t$残差序列,可能需要拟合自回归提取相关性</li><li>$h_t$包含ARCH和GARCH项,对方差非齐进行拟合</li></ul><h6 id="3-AR-GARCH模型"><a href="#3-AR-GARCH模型" class="headerlink" title="3. AR-GARCH模型"></a>3. AR-GARCH模型</h6><p>当对原序列提取确定性信息不充分时,$ε_t$可能具有相关性,而不是纯随机性.这时可能先对$ε_t$拟合回归模型,在考察回归残差序列$ν_t$的方差齐性</p><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/assets/garch_1/b.png" alt=""></h2><h4 id="拟合案例"><a href="#拟合案例" class="headerlink" title="拟合案例"></a>拟合案例</h4><h6 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述:"></a>问题描述:</h6><ul><li>1969年1月至1994年8月澳大利亚储备银行2年期有价证券阅读利率数据如下;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">4.9955.035.035.255.265.35.455.495.525.7</span><br><span class="line">5.685.655.86.56.456.486.456.356.46.436.43</span><br><span class="line">6.446.456.486.46.356.46.36.326.356.135.7</span><br><span class="line">5.585.185.185.175.155.215.235.054.654.654.6</span><br><span class="line">4.674.694.684.624.634.95.445.566.046.066.06</span><br><span class="line">8.078.078.18.058.068.078.068.118.610.811</span><br><span class="line">11119.489.188.628.38.478.448.448.468.49</span><br><span class="line">8.548.548.58.448.498.48.468.58.58.478.47</span><br><span class="line">8.478.488.488.548.568.398.899.919.899.919.91</span><br><span class="line">9.99.889.869.869.749.429.279.268.998.838.83</span><br><span class="line">8.838.828.838.838.798.798.698.668.678.728.77</span><br><span class="line">99.619.79.949.949.949.959.949.969.9710.83</span><br><span class="line">10.7511.211.411.5411.511.3411.511.511.5812.4212.85</span><br><span class="line">13.113.1213.113.1513.113.214.214.7514.614.614.45</span><br><span class="line">14.514.815.8516.216.516.416.416.3516.113.713.5</span><br><span class="line">1412.31214.3514.612.512.7513.713.4513.5512.6</span><br><span class="line">121111.612.0512.3512.712.4512.5512.212.111.15</span><br><span class="line">11.8512.112.512.912.513.213.6513.6513.513.4513.35</span><br><span class="line">14.4514.315.0515.5515.6514.6514.1513.312.6512.712.8</span><br><span class="line">14.515.115.1514.314.2514.0514.715.0514.0513.813.25</span><br><span class="line">1312.8512.611.81312.3511.4511.3511.5510.8510.9</span><br><span class="line">12.311.712.0512.312.913.0513.313.8514.6515.0515.15</span><br><span class="line">14.8515.715.415.114.815.815.81514.413.814.3</span><br><span class="line">14.1514.4514.114.0513.7513.31312.5512.2511.8511.5</span><br><span class="line">11.111.1510.710.2510.5510.2510.39.68.48.27.25</span><br><span class="line">8.358.258.37.47.156.355.657.47.27.057.1</span><br><span class="line">6.856.56.255.955.655.855.455.35.25.555.15</span><br><span class="line">5.45.355.15.86.356.56.958.057.758.6</span><br></pre></td></tr></table></figure></li></ul><p>1.考察方差齐性;<br>2.选择适当的模型拟合该序列的发展;</p><hr><h6 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤:"></a>解题步骤:</h6><h6 id="1-建立数据集和时间"><a href="#1-建立数据集和时间" class="headerlink" title="1. 建立数据集和时间"></a>1. 建立数据集和时间</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data a;</span><br><span class="line">input x@@;</span><br><span class="line">lagx=lag(x);</span><br><span class="line">difx=dif(x);</span><br><span class="line">t=intnx(&apos;month&apos;,&apos;1jan1969&apos;d,_n_-1);</span><br><span class="line">cards;</span><br><span class="line">....  # 数据</span><br><span class="line">;</span><br></pre></td></tr></table></figure><h6 id="2-对原序列和一阶差分后序列进行时序图绘制"><a href="#2-对原序列和一阶差分后序列进行时序图绘制" class="headerlink" title="2. 对原序列和一阶差分后序列进行时序图绘制"></a>2. 对原序列和一阶差分后序列进行时序图绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc gplot data=a;</span><br><span class="line">plot x*t difx*t;</span><br><span class="line">symbol c=red i=join v=star;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><p><img src="/assets/garch_1/1.png" alt="x*t"></p><p><img src="/assets/garch_1/2.png" alt="difx*t"></p><h2 id="分析-原序列非平稳-一阶差分序列平稳且存在异方差现象-集群效应"><a href="#分析-原序列非平稳-一阶差分序列平稳且存在异方差现象-集群效应" class="headerlink" title="分析 : 原序列非平稳,一阶差分序列平稳且存在异方差现象(集群效应)"></a><em>分析</em> : 原序列非平稳,一阶差分序列平稳且存在异方差现象(<em>集群效应</em>)</h2><h6 id="3-绘制原序列和一阶差分序列相关图"><a href="#3-绘制原序列和一阶差分序列相关图" class="headerlink" title="3.绘制原序列和一阶差分序列相关图"></a>3.绘制原序列和一阶差分序列相关图</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc arima data=a;</span><br><span class="line">identify var=x;</span><br><span class="line">identify var=x(1);</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><p><img src="/assets/garch_1/3.png" alt="原序列相关图"></p><p><img src="/images/placeholder.png" alt="一阶差分序列相关图" data-src="/assets/garch_1/4.png" class="lazyload"></p><h2 id="分析-原序列长期相关-一阶差分序列具有平稳性-但也存在拖尾"><a href="#分析-原序列长期相关-一阶差分序列具有平稳性-但也存在拖尾" class="headerlink" title="分析 : 原序列长期相关,一阶差分序列具有平稳性,但也存在拖尾"></a><em>分析</em> : 原序列长期相关,一阶差分序列具有平稳性,但也存在拖尾</h2><h6 id="4-对原序列提取趋势信息-绘制残差序列五阶自相关图-并对残差序列进行dw检验-确定相关性信息"><a href="#4-对原序列提取趋势信息-绘制残差序列五阶自相关图-并对残差序列进行dw检验-确定相关性信息" class="headerlink" title="4. 对原序列提取趋势信息,绘制残差序列五阶自相关图,并对残差序列进行dw检验,确定相关性信息"></a>4. 对原序列提取趋势信息,绘制残差序列五阶自相关图,并对残差序列进行dw检验,确定相关性信息</h6><p><strong>提取方式</strong></p><ul><li>自变量t的幂函数提取趋势信息<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=5 dwprob ;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/images/placeholder.png" alt="参数检测" data-src="/assets/garch_1/5.png" class="lazyload"></p><ul><li>滞后变量的方式提取<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=lagx/ lagdep=lagx nlag=5 dwprob; # 均值不显著,可添加 noint</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/images/placeholder.png" alt="参数检测" data-src="/assets/garch_1/6.png" class="lazyload"><br><strong>五阶相关图</strong><br><img src="/images/placeholder.png" alt="t提取" data-src="/assets/garch_1/7.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="lagx提取" data-src="/assets/garch_1/8.png" class="lazyload"></p><p><em>残差自相关仍具有相关和拖尾特征,残差序列仍有相关性</em></p><p><strong>dw检验</strong><br><img src="/images/placeholder.png" alt="t提取" data-src="/assets/garch_1/9.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="lagx提取" data-src="/assets/garch_1/10.png" class="lazyload"></p><p><em>两者提取后的残差序列仍具有相关性</em></p><hr><h6 id="5-对第一次残差拟合一次AR-2-模型-并对第二次残差进行archtest检验"><a href="#5-对第一次残差拟合一次AR-2-模型-并对第二次残差进行archtest检验" class="headerlink" title="5. 对第一次残差拟合一次AR(2)模型,并对第二次残差进行archtest检验"></a>5. 对第一次残差拟合一次AR(2)模型,并对第二次残差进行archtest检验</h6><p><strong>第一次残差拟合</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=5 noint backstep method=ml archtest;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><img src="/images/placeholder.png" alt="AR(2)参数通过检验" data-src="/assets/garch_1/11.png" class="lazyload"></p><p><strong>archtest检测</strong><br><img src="/images/placeholder.png" alt="Q.LM检测" data-src="/assets/garch_1/12.png" class="lazyload"><br><em>对$ε_t$拟合AR(2),Q.LM检测显示长期相关性,可以拟合GARCH模型</em></p><h6 id="6-最终模型拟合AR-2-GARCH-1-1"><a href="#6-最终模型拟合AR-2-GARCH-1-1" class="headerlink" title="6. 最终模型拟合AR(2)-GARCH(1,1)"></a>6. 最终模型拟合AR(2)-GARCH(1,1)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=a;</span><br><span class="line">model x=t/ nlag=2 noint garch=(p=1,q=1);</span><br><span class="line">output out=out p=p lcl=lcl ucl=ucl cev=cev residual=residual;  # 数据输出</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><p><img src="/images/placeholder.png" alt="参数检验" data-src="/assets/garch_1/13.png" class="lazyload"></p><h6 id="7-绘制"><a href="#7-绘制" class="headerlink" title="7. 绘制"></a>7. 绘制</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">data out;</span><br><span class="line">set out;</span><br><span class="line">lcl_residul=-1.96*sqrt(0.27415);</span><br><span class="line">Ucl_residul=1.96*sqrt(0.27415);</span><br><span class="line">Lcl_GARCH=-1.96*sqrt(cev);</span><br><span class="line">Ucl_GARCH=1.96*sqrt(cev);</span><br><span class="line">Lcl_P=P-1.96*sqrt(cev);</span><br><span class="line">Ucl_P=P+1.96*sqrt(cev);</span><br><span class="line">proc gplot data=out;</span><br><span class="line">plot x*t=5  lcl*t=3 ucl*t=3 Lcl_P*t=4 Ucl_P*t=4/overlay;</span><br><span class="line">plot residual*t=2 lcl_residul*t=3 Ucl_residul*t=3 Lcl_GARCH*t=4 Ucl_GARCH*t=4/overlay;</span><br><span class="line">symbol2 c=green i=needle v=none;</span><br><span class="line">symbol3 c=black i=join v=none w=2 l=2;</span><br><span class="line">symbol4 c=red i=join v=none;</span><br><span class="line">symbol5 c=green i=join v=none;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><p><img src="/images/placeholder.png" alt="拟合图" data-src="/assets/garch_1/14.png" class="lazyload"></p><p><img src="/images/placeholder.png" alt="残差波动拟合" data-src="/assets/garch_1/15.png" class="lazyload"></p>]]></content>
      
      
        <tags>
            
            <tag> SAS </tag>
            
            <tag> 时间序列 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ARCH模型拟合案例</title>
      <link href="/2018/11/21/arch-1/"/>
      <content type="html"><![CDATA[<blockquote><p>ARCH模型的构建已经在<a href="https://www.jianshu.com/p/f26aed349903" target="_blank" rel="noopener">这里</a>有所叙述,这次使用一个案例回顾过程.</p></blockquote><a id="more"></a><hr><h5 id="1-问题描述"><a href="#1-问题描述" class="headerlink" title="1. 问题描述:"></a>1. 问题描述:</h5><ul><li><p>1750-1849年瑞典人口出生率数据给出;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">9  12 8 12 10 10 8 2 0 7 10 9</span><br><span class="line">4 1 7 5 8 9 5 5 6 4 -9 -27 12</span><br><span class="line">10 10 8 8 9 14 7 4 1 1 2 6 7</span><br><span class="line">7 -2 -1 7 12 10 10 4 9 10 9</span><br><span class="line">5 4 3 7 7 6 8 3 4 -5 -14 1</span><br><span class="line">6 3 2 6 1 13 10 10 6 9 10</span><br><span class="line">13 16 14 16 12 8 7 6 9 4</span><br><span class="line">7 12 8 14 11 5 5 5 10 11</span><br><span class="line">11 9 12 13 8 6 10 13</span><br></pre></td></tr></table></figure></li><li><p>要求:<br>(1):选择适合的模型拟合序列发展;<br>(2):检验序列的异方差性,存在请拟合相应的条件异方差模型;</p></li></ul><hr><h5 id="2-解题"><a href="#2-解题" class="headerlink" title="2.解题"></a>2.解题</h5><ul><li>导入数据<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">data birth;</span><br><span class="line">input br@@;</span><br><span class="line">lagbr=lag(br);</span><br><span class="line">difbr=dif(br);</span><br><span class="line">year=intnx(&apos;year&apos;,&apos;01jan1750&apos;d, _n_-1);</span><br><span class="line">format year monyy7.;</span><br><span class="line">cards;</span><br><span class="line">9 12 8 12 10 10 8 2 0 7 10 9</span><br><span class="line">4 1 7 5 8 9 5 5 6 4 -9 -27 12</span><br><span class="line">10 10 8 8 9 14 7 4 1 1 2 6 7</span><br><span class="line">7 -2 -1 7 12 10 10 4 9 10 9</span><br><span class="line">5 4 3 7 7 6 8 3 4 -5 -14 1</span><br><span class="line">6 3 2 6 1 13 10 10 6 9 10</span><br><span class="line">13 16 14 16 12 8 7 6 9 4</span><br><span class="line">7 12 8 14 11 5 5 5 10 11</span><br><span class="line">11 9 12 13 8 6 10 13 </span><br><span class="line">;</span><br></pre></td></tr></table></figure></li></ul><hr><h6 id="1-对原序列的基本分析-绘制时序图"><a href="#1-对原序列的基本分析-绘制时序图" class="headerlink" title="1. 对原序列的基本分析,绘制时序图"></a>1. 对原序列的基本分析,绘制时序图</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc gplot data=birth;</span><br><span class="line">plot br*t lagbr*t difbr*t;</span><br><span class="line">symbol i=join v=star c=red;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><ul><li><em>原序列时序图</em> (滞后一阶时序图与原序列无差)<br><img src="/assets/arch_1/1.png" alt="br*t"></li><li><em>一阶差分时序图</em> (出现了比较明显的异方差现象;<em>集群效应</em>)<br><img src="/assets/arch_1/2.png" alt="difbr*t"></li></ul><hr><h6 id="2-arima绘制相关图-对原序列和一阶差分"><a href="#2-arima绘制相关图-对原序列和一阶差分" class="headerlink" title="2. arima绘制相关图 (对原序列和一阶差分)"></a>2. arima绘制相关图 (对原序列和一阶差分)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc arima data=birth;</span><br><span class="line">identify var=br;</span><br><span class="line">identify var=br(1);</span><br><span class="line">run;</span><br></pre></td></tr></table></figure><p><em>原序列自相关</em> (自相关图表现出短期相关性,偏自相关图类似,因此一阶差分后序列具有更好的平稳性质)<br><img src="/assets/arch_1/3.png" alt="br自相关图"></p><h6 id="3-对原序列提取确定性信息-画出残差序列的五阶自相关图-并对提取后残差序列进行dw检验-判断残差序列是否仍具有相关性"><a href="#3-对原序列提取确定性信息-画出残差序列的五阶自相关图-并对提取后残差序列进行dw检验-判断残差序列是否仍具有相关性" class="headerlink" title="3. 对原序列提取确定性信息,画出残差序列的五阶自相关图,并对提取后残差序列进行dw检验(判断残差序列是否仍具有相关性)"></a>3. 对原序列提取确定性信息,画出残差序列的五阶自相关图,并对提取后残差序列进行dw检验(判断残差序列是否仍具有相关性)</h6><p><em>自变量为t的幂函数提取</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=birth;</span><br><span class="line">model br=t/ nlag=5 dwprob;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><img src="/assets/arch_1/5.png" alt="关于t的幂函数提取"></p><hr><p><em>自变量为滞后值提取</em> (可以基本对残差序列定阶为p=1)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=birth;</span><br><span class="line">model br=lagbr/ lagdep=lagbr nlag=5 dwprob;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><img src="/assets/arch_1/6.png" alt="滞后因变量提取"></p><ul><li>五阶自相关图表明参数序列自具有短期相关性,可以只建立ARCH模型</li></ul><p><img src="/images/placeholder.png" alt="残差五阶自相关图" data-src="/assets/arch_1/7.png" class="lazyload"></p><ul><li>参数检验通过</li></ul><p><img src="/images/placeholder.png" alt="参数检验" data-src="/assets/arch_1/8.png" class="lazyload"></p><hr><h6 id="4-定阶拟合-上述-残差序列模型确定为ARCH-1"><a href="#4-定阶拟合-上述-残差序列模型确定为ARCH-1" class="headerlink" title="4.定阶拟合(上述,残差序列模型确定为ARCH(1))"></a>4.定阶拟合(上述,残差序列模型确定为ARCH(1))</h6><p><em>code</em>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg data=birth;</span><br><span class="line">model br=lagbr/ lagdep=lagbr garch=(p=1);</span><br><span class="line">output out=out p=p lcl=lcl ucl=ucl cev=cev residual=residual;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><em>参数检验</em></p><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/images/placeholder.png" alt="results" data-src="/assets/arch_1/9.png" class="lazyload"></h2><h6 id="5-图形绘制"><a href="#5-图形绘制" class="headerlink" title="5. 图形绘制"></a>5. 图形绘制</h6><p><em>数据处理</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data out;</span><br><span class="line">set out;</span><br><span class="line">lcl_residul=-1.96*sqrt(27.47293);</span><br><span class="line">Ucl_residul=1.96*sqrt(27.47293);</span><br><span class="line">Lcl_GARCH=-1.96*sqrt(cev);</span><br><span class="line">Ucl_GARCH=1.96*sqrt(cev);</span><br><span class="line">Lcl_P=P-1.96*sqrt(cev);</span><br><span class="line">Ucl_P=P+1.96*sqrt(cev);</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><em>绘图</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">proc gplot data=out;</span><br><span class="line">plot a*t=2  lcl*t=3 ucl*t=3 Lcl_P*t=4 Ucl_P*t=4/overlay;</span><br><span class="line">plot residual*t=2 lcl_residul*t=3 Ucl_residul*t=3 Lcl_GARCH*t=4  Ucl_GARCH*t=4/overlay;</span><br><span class="line">symbol2 c=green i=needle v=none;</span><br><span class="line">symbol3 c=black i=join v=none;</span><br><span class="line">symbol4 c=red i=join v=none ;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></p><p><em>拟合图</em></p><p><img src="/images/placeholder.png" alt="" data-src="/assets/arch_1/10.png" class="lazyload"></p>]]></content>
      
      
        <tags>
            
            <tag> SAS </tag>
            
            <tag> 时间序列 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>条件异方差模型</title>
      <link href="/2018/11/17/archmodel/"/>
      <content type="html"><![CDATA[<blockquote><p>对于异方差序列的精确拟合,有方差齐性变化以及条件异方差模型两种方法.实践中,异方差函数的具体形式一般未知,因此在宏观经济领域和金融领域广泛采用条件异方差模型对异方差波动进行处理</p></blockquote><a id="more"></a><hr><h5 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h5><h5 id="1-集群效应"><a href="#1-集群效应" class="headerlink" title="1. 集群效应"></a>1. <strong>集群效应</strong></h5><p>对于提取完毕确定性信息之后,残差序列的波动,具有某些时段波动持续偏大的特征,如图示</p><!-- more --><p><img src="/assets/GARCH/0.png" alt="集群效应时序图"></p><ul><li><strong>说明:</strong> 集群效应,其本质是异方差现象.出现集群效应的时间序列,其方差基本齐性,但存在某段或某几段方差异与期望方差.因此基于齐性方差的分析方法无法确切拟合.通常,意味着需要引用 <em>条件方差模型</em></li></ul><hr><h5 id="2-ARCH-模型"><a href="#2-ARCH-模型" class="headerlink" title="2. ARCH 模型"></a>2. <strong>ARCH 模型</strong></h5><p> 全称,自回归条件方差模型(autoregressive conditional heteroskedastic),1982. <em>Engle</em> 提出</p><ol><li><p><strong>构造原理:</strong> 假设在历史数据已知的情况下,零均值、纯随机残差序列具有异方差性.<br>$$Var(ε_t)=h_t$$<br>在满足正态分布的假定下,异方差等价于残差平方的均值<br>$$E(ε^2_t)=h_t$$<br>ARCH模型可以提取残差平方序列的相关信息,以获得原序列异方差特征.</p></li><li><p><strong>模型意图:</strong> 在已知的ARIMA模型,残差自回归模型,以及确定性因素的分解模型拟合的是序列的平均水平,本质上只是一个点估计,无法给出估计的精度.或者说由于假定了方差齐性,其给出的区间估计是一个定值.对于存在异方差现象的序列无法精确的拟合.<br><code>图片</code><br>上述提到构建ARCH模型的意图是使用自回归提取误差平方序列的相关信息.它的条件方差是一个时变函数,更能及时的反映序列即期波动的特征,即异方差特征</p></li><li><p><strong>ARCH检验:</strong> 在拟合ARCH模型的开始,需要对序列进行ARCH检验.要求序列的异方差是由于某种自相关性造成的.常用的两种统计方法: <em>Portmanteau Q</em> 检验和 <em>LM检验</em></p></li></ol><ul><li><em>Portmanteau Q</em>检验:  构造思想是如果残差序列方差非齐,且具有集群效应,那么残差平方序列通常具有自相关性.所以方差非齐的检验可以转换为残差平方序列的自相关检验<br>假设条件:<br><img src="/assets/GARCH/1.png" alt=""></li></ul><p>当<code>Q(q)</code>统计量的P值小于显著水平<code>α</code>时,拒绝原假设,认为该序列方差非齐且具有自相关关系</p><ul><li><em>LM检验</em>: 构造思想是如果残差序列方差非齐,且具有集群效应,那么残差序列具有自相关性.因此可以尝试对残差平方序列进行自回归模型的拟合(<code>ARCH(q)</code>模型)</li></ul><p>$$ε^2_t=ω+ \sumλ<em>jε^2</em>{t-j}+e_t$$<br>假设条件:<br><img src="/assets/GARCH/1.png" alt=""></p><p>于是方差齐性的检验转换成这个方差是否显著成立的检验,若方差显著,意味着残差平方序列具有自相关性,可以用该回归方差提取自相关信息.</p><h2 id="决策-P值小于显著水平α时-拒绝原假设-认为该序列方差非齐-并且可以使用q阶自回归拟合残差平方序列的自相关关系"><a href="#决策-P值小于显著水平α时-拒绝原假设-认为该序列方差非齐-并且可以使用q阶自回归拟合残差平方序列的自相关关系" class="headerlink" title="决策:P值小于显著水平α时,拒绝原假设,认为该序列方差非齐,并且可以使用q阶自回归拟合残差平方序列的自相关关系"></a>决策:P值小于显著水平<code>α</code>时,拒绝原假设,认为该序列方差非齐,并且可以使用q阶自回归拟合残差平方序列的自相关关系</h2><ol><li><strong>实例应用</strong><br><em>对1926-1991年标普500股票股价波动的模型拟合</em></li></ol><ul><li><p>导入数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data a;</span><br><span class="line">input return@@;</span><br><span class="line">t=intnx(&apos;month&apos;,&apos;1oct1926&apos;d,_n_-1);</span><br><span class="line">format t monyy5.;</span><br><span class="line">cards;</span><br><span class="line">...  # 数据集较大</span><br><span class="line">...  # 省略号代替</span><br><span class="line">...</span><br><span class="line">;</span><br></pre></td></tr></table></figure></li><li><p>(可选)对原序列进行模型识别,尝试建立ARMA模型失败.由图,序列自相关系数落在两倍标准差之上,具有长期自相关的特征</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proc arima;</span><br><span class="line">identify var=return minic;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/assets/GARCH/3.png" alt="自相关图"></p><p>序列总体定阶 q=3</p><p><img src="/assets/GARCH/7.png" alt="最小信息准则"></p><ul><li>考虑建立残差自回归模型<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">proc autoreg;</span><br><span class="line"></span><br><span class="line"># 指令系统建立序列return的线性回归模型,</span><br><span class="line">#绘制残差序列的5阶自相关图,输出dw检验及P值,对残差序列进行异方差检验.</span><br><span class="line"># garch=(q=3) noint 通过对输出的分析后加的</span><br><span class="line">model return=t/nlag=5 dwprob archtest garch=(q=3) noint;</span><br><span class="line"></span><br><span class="line"># 输出到out数据集中</span><br><span class="line">output  out=out lcl=lcl ucl=ucl cev=cev;</span><br></pre></td></tr></table></figure></li></ul><p>DW检验显示与时间t不存在相关性</p><p><img src="/images/placeholder.png" alt="普通最小二乘估计输出结果" data-src="/assets/GARCH/4.png" class="lazyload"></p><p>残差序列5阶滞后自相关图不存在截尾特征</p><p><img src="/images/placeholder.png" alt="残差序列5阶滞后自相关图" data-src="/assets/GARCH/5.png" class="lazyload"></p><p>异方差检验,拒绝原假设,方差非齐</p><p><img src="/images/placeholder.png" alt="异方差检验结果" data-src="/assets/GARCH/6.png" class="lazyload"></p><p>结合自相关图和异方差检验,拟合ARCH(3)模型</p><p><img src="/images/placeholder.png" alt="最终模型参数检验" data-src="/assets/GARCH/8.png" class="lazyload"></p><ul><li>对建立的模型进行汇图<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data out;</span><br><span class="line">set out;</span><br><span class="line">Lcl_ARCH=-1.96*sqrt(cev);</span><br><span class="line">Ucl_ARCH=1.96*sqrt(cev);</span><br><span class="line">proc gplot data=out;</span><br><span class="line">plot return*t=2 lcl*t=3 LCL_arch*t=4 ucl*t=3 UCL_arch*t=4 /overlay;</span><br><span class="line">symbol2 c=green i=needle v=none ;</span><br><span class="line">symbol3 c=black i=join v=none w=2 l=2;</span><br><span class="line">symbol4 c=red i=join v=none ;</span><br><span class="line">run;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/images/placeholder.png" alt="拟合图" data-src="/assets/GARCH/9.png" class="lazyload"></p>]]></content>
      
      
        <tags>
            
            <tag> SAS </tag>
            
            <tag> 时间序列 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello 城中乌</title>
      <link href="/2018/10/20/HelloSenye/"/>
      <content type="html"><![CDATA[<h3 id="Senye"><a href="#Senye" class="headerlink" title="Senye"></a>Senye</h3><blockquote><p>本站点<code>Senye</code>由<code>hexo+githubpages+阿里云域名解析</code>构建的,把大致的流程记录下来,以供参考</p></blockquote><a id="more"></a><p><img src="/assets/hs.jpg" alt="blog"></p><h2 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h2><h3 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h3><h4 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h4><p><code>Hexo</code>是一个开源的静态博客生成器,用node.js开发，支持<code>Markdown</code>格式，有众多优秀插件和主题，Hexo可以将在本地写好的<code>.md</code>文件调用命令来批量完成相关静态页面的创建，然后再将有改动的页面提交到<code>github</code>实现文章发布</p><h4 id="githubpages"><a href="#githubpages" class="headerlink" title="githubpages"></a>githubpages</h4><p><code>github</code>有一个，叫做<code>github pages</code>的项目，这个项目是给开发者建立一个私人网站页面，上面用来分享新颖的想法和自己写的代码，githubpages只能存放的都是静态文件，虽然有局限，但是用来作为个人博客再合适不过了</p><h4 id="阿里云域名解析"><a href="#阿里云域名解析" class="headerlink" title="阿里云域名解析"></a>阿里云域名解析</h4><p><code>阿里云域名解析</code>，当然，你不绑定域名肯定也是可以的，通过<code>https://xxx.github.io</code>访问。但是为了突出，对吧，有必要安排一下的</p><h2 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h2><h3 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h3><p>在<code>github</code>上注册账号，创建一个仓库，名称为<code>账户名.github.io</code>,参考地址:<code>https://jingyan.baidu.com/article/acf728fd64b5a2f8e510a31d.html</code></p><h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><p><code>Git</code>是开源的分布式版本控制系统，用于敏捷高效地处理项目。我们网站在本地搭建好了，需要使用git同步到github上,安装地址<code>https://git-scm.com/downloads</code>，假设到你是<code>Windows10</code>系统，安装完成后，右击鼠标进入到<code>git</code>命令行</p><h3 id="配置ssh秘钥"><a href="#配置ssh秘钥" class="headerlink" title="配置ssh秘钥"></a>配置ssh秘钥</h3><p>关于配置和ssh秘钥，参考这篇博:<code>https://www.cnblogs.com/flora5/p/7152556.html</code></p><h2 id="使用hexo主题"><a href="#使用hexo主题" class="headerlink" title="使用hexo主题"></a>使用hexo主题</h2><h3 id="运行环境配置"><a href="#运行环境配置" class="headerlink" title="运行环境配置"></a>运行环境配置</h3><p>在githubpages上部署hexo主题，需要现在本地配置好<code>node.js</code>环境，node.js下载地址:<code>https://nodejs.org/en/download/</code>。需要注意的是，安装node.js会包含环境变量及<code>npm</code>的安装。在命令行输入<code>node -v、npm -v</code>检测是否安装成功</p><h3 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h3><p>命令行<code>npm install -g hexo-cli</code></p><h3 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h3><p>hexo静态网站有一定的目录结构，在hexo的官方文档<code>https://hexo.io/zh-cn/docs/themes</code>中详细的介绍，同时作为一个优秀的开源项目，热爱这个项目的创造者们早已经分享了太多的优秀模板,地址:<code>https://hexo.io/themes/</code>，通过修改<code>_config.yml</code>来定制自己的个人博客，参考hexo官方文档和有关博客:<code>https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html</code></p><h2 id="阿里云域名部署"><a href="#阿里云域名部署" class="headerlink" title="阿里云域名部署"></a>阿里云域名部署</h2><p>在阿里云买好域名并实名认证之后，就可以给自己的博客站点更名了</p><h3 id="添加CNAME文件"><a href="#添加CNAME文件" class="headerlink" title="添加CNAME文件"></a>添加CNAME文件</h3><p>在本地的hexo文件夹根目录下的<code>source</code>文件下新建<code>CNAEM</code>文件，并添加自己申请的域名信息，然后部署到<code>github</code>上去</p><h3 id="配置settings"><a href="#配置settings" class="headerlink" title="配置settings"></a>配置settings</h3><p>在网站项目的<code>Settings</code>中，添加自己的域名到<code>Custom domin</code></p><h3 id="添加域名解析记录"><a href="#添加域名解析记录" class="headerlink" title="添加域名解析记录"></a>添加域名解析记录</h3><h4 id="1-ping-yourname-github-io获取ip地址"><a href="#1-ping-yourname-github-io获取ip地址" class="headerlink" title="1. ping yourname.github.io获取ip地址"></a>1. ping yourname.github.io获取ip地址</h4><h4 id="2-打开阿里的域名管理，在解析列表中添加两条解析记录"><a href="#2-打开阿里的域名管理，在解析列表中添加两条解析记录" class="headerlink" title="2. 打开阿里的域名管理，在解析列表中添加两条解析记录"></a>2. 打开阿里的域名管理，在解析列表中添加两条解析记录</h4><table><thead><tr><th style="text-align:center">记录类型</th><th style="text-align:center">主机记录</th><th style="text-align:center">记录值</th></tr></thead><tbody><tr><td style="text-align:center">CNAME</td><td style="text-align:center">www</td><td style="text-align:center">yourname.github.io</td></tr><tr><td style="text-align:center">A</td><td style="text-align:center">@</td><td style="text-align:center">ip地址</td></tr></tbody></table>]]></content>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> theme </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
